<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Sinhala Writer - Siri Sinhala Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+Sinhala:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Kiwi+Maru:wght@500&display=swap" rel="stylesheet">
    <style>
        :root {
    --primary: #4361ee;
    --primary-dark: #3a56d4;
    --secondary: #7209b7;
    --accent: #f72585;
    --success: #4cc9f0;
    --warning: #ff9e00;
    --pink-light: #ffb6c1;
    --bg-dark: #0a0a0f;
    --bg-card: #141420;
    --bg-surface: #1e1e2d;
    --text-primary: #ffffff;
    --text-secondary: #b0b0c0;
    --text-muted: #8a8a9a;
    --border: #2d2d3d;
    --border-light: #3a3a4a;
    --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    --shadow-lg: 0 20px 50px rgba(0, 0, 0, 0.4);
    --radius: 16px;
    --radius-sm: 8px;
    --gradient: linear-gradient(135deg, #4361ee, #7209b7);
    --gradient-accent: linear-gradient(135deg, #f72585, #ff006e);
    --gradient-success: linear-gradient(135deg, #4cc9f0, #00b4d8);
    --gradient-pink: linear-gradient(135deg, #ffb6c1, #ff69b4);
    
    /* Komi Character Variables */
    --komi-black: #413564;
    --komi-white: #fff;
    --komi-primary-color: #554684;
    --komi-primary-color-dark: #413564;
    --komi-primary-color-tint: #8979b9;
    --komi-secondary-color: #fff5f0;
    --komi-accent-color: #ff4dde;
    --komi-sparkle-color: #ffe085;
    --komi-shirt-color: #fff;
    --komi-shirt-color-dark: #eaeaea;
    --komi-shirt-color-dark-2: #ddd;
    --komi-bow-color-1: #961E60;
    --komi-bow-color-2: #411854;
    --komi-bow-gradient: repeating-linear-gradient(-45deg, var(--komi-bow-color-1) 0 0.25rem, var(--komi-bow-color-2) 0.25rem 0.375rem);
    --komi-background: #c4bcdc;
    --komi-line-width-1: 0.125rem;
    --komi-line-width-2: 0.375rem;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    background: var(--bg-dark);
    color: var(--text-primary);
    font-family: 'Inter', 'Noto Sans Sinhala', sans-serif;
    line-height: 1.6;
    min-height: 100vh;
    padding: 20px;
    position: relative;
    overflow-x: hidden;
}

body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: 
        radial-gradient(circle at 10% 20%, rgba(67, 97, 238, 0.15) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(114, 9, 183, 0.15) 0%, transparent 20%),
        radial-gradient(circle at 50% 50%, rgba(247, 37, 133, 0.1) 0%, transparent 30%);
    z-index: -1;
    pointer-events: none;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

/* Header */
.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 25px 0;
    margin-bottom: 30px;
    flex-wrap: wrap;
    gap: 20px;
}

.logo-container {
    display: flex;
    align-items: center;
    gap: 15px;
}

.logo {
    width: 50px;
    height: 50px;
    background: var(--gradient);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    font-weight: bold;
    box-shadow: var(--shadow);
}

.title-container h1 {
    font-size: 2.2rem;
    font-weight: 700;
    background: var(--gradient);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    margin-bottom: 5px;
}

.title-container .subtitle {
    color: var(--text-secondary);
    font-size: 0.9rem;
    font-weight: 400;
}

/* Anime Assistant */
.anime-assistant {
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 120px;
    height: 150px;
    z-index: 100;
    cursor: pointer;
    transition: transform 0.3s ease;
}

.anime-assistant:hover {
    transform: scale(1.05) translateY(-5px);
}

.anime-body {
    position: relative;
    width: 100px;
    height: 130px;
    background: var(--gradient-pink);
    border-radius: 40% 40% 45% 45%;
    margin: 0 auto;
    box-shadow: var(--shadow);
    animation: float 3s ease-in-out infinite;
}

@keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
}

.anime-face {
    position: absolute;
    top: 30px;
    left: 50%;
    transform: translateX(-50%);
    width: 60px;
    height: 50px;
}

.anime-eyes {
    display: flex;
    justify-content: space-between;
    padding: 0 10px;
}

.anime-eye {
    width: 12px;
    height: 18px;
    background: white;
    border-radius: 50%;
    position: relative;
    overflow: hidden;
}

.anime-eye::after {
    content: '';
    position: absolute;
    width: 6px;
    height: 6px;
    background: #333;
    border-radius: 50%;
    top: 4px;
    left: 3px;
    animation: blink 3s infinite;
}

@keyframes blink {
    0%, 45%, 55%, 100% { transform: scaleY(1); }
    50% { transform: scaleY(0.1); }
}

.anime-mouth {
    width: 20px;
    height: 8px;
    background: #ff6b6b;
    border-radius: 0 0 10px 10px;
    margin: 8px auto 0;
}

.anime-hair {
    position: absolute;
    top: -15px;
    left: 50%;
    transform: translateX(-50%);
    width: 80px;
    height: 30px;
    background: #ff69b4;
    border-radius: 40% 40% 0 0;
}

.anime-speech {
    position: absolute;
    bottom: 150px;
    right: 0;
    background: white;
    color: #333;
    padding: 10px 15px;
    border-radius: 15px;
    box-shadow: var(--shadow);
    width: 200px;
    font-size: 0.85rem;
    display: none;
}

.anime-speech::after {
    content: '';
    position: absolute;
    bottom: -10px;
    right: 20px;
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    border-top: 10px solid white;
}

/* Stats & Controls */
.stats-container {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
}

.stat-box {
    background: var(--bg-card);
    padding: 12px 20px;
    border-radius: var(--radius-sm);
    border: 1px solid var(--border);
    min-width: 140px;
    box-shadow: var(--shadow);
    transition: all 0.3s ease;
}

.stat-box:hover {
    transform: translateY(-3px);
    border-color: var(--primary);
}

.stat-label {
    display: block;
    font-size: 0.85rem;
    color: var(--text-muted);
    margin-bottom: 5px;
}

.stat-value {
    display: block;
    font-size: 1.4rem;
    font-weight: 600;
    color: var(--success);
}

/* Main Editor Area */
.editor-container {
    background: var(--bg-card);
    border-radius: var(--radius);
    padding: 25px;
    margin-bottom: 30px;
    box-shadow: var(--shadow-lg);
    border: 1px solid var(--border);
    position: relative;
    overflow: hidden;
}

.editor-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid var(--border);
    flex-wrap: wrap;
    gap: 15px;
}

.editor-title {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 10px;
}

.editor-actions {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.btn {
    padding: 8px 16px;
    border-radius: var(--radius-sm);
    border: none;
    font-family: inherit;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.9rem;
}

.btn-primary {
    background: var(--gradient);
    color: white;
}

.btn-secondary {
    background: var(--bg-surface);
    color: var(--text-primary);
    border: 1px solid var(--border-light);
}

.btn-success {
    background: var(--gradient-success);
    color: white;
}

.btn-warning {
    background: linear-gradient(135deg, #ff9e00, #ff9100);
    color: white;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow);
}

/* Text Editor */
#editor {
    width: 100%;
    min-height: 300px;
    background: transparent;
    border: none;
    color: var(--text-primary);
    font-size: 18px;
    line-height: 1.7;
    outline: none;
    resize: vertical;
    font-family: 'Noto Sans Sinhala', 'Inter', sans-serif;
    padding: 10px 0;
    overflow-y: auto;
}

#editor::placeholder {
    color: var(--text-muted);
    font-style: italic;
    font-size: 16px;
}

.editor-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 20px;
    padding-top: 15px;
    border-top: 1px solid var(--border);
    color: var(--text-secondary);
    font-size: 0.85rem;
    flex-wrap: wrap;
    gap: 15px;
}

/* Auto Complete Guide */
.auto-guide {
    background: rgba(67, 97, 238, 0.1);
    border: 1px solid var(--primary);
    border-radius: var(--radius-sm);
    padding: 15px;
    margin-top: 15px;
    display: none;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}

.guide-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.guide-title {
    font-weight: 600;
    color: var(--primary);
    display: flex;
    align-items: center;
    gap: 8px;
}

.guide-content {
    color: var(--text-secondary);
    font-size: 0.9rem;
    line-height: 1.5;
}

.guide-close {
    background: none;
    border: none;
    color: var(--text-muted);
    cursor: pointer;
    font-size: 16px;
}

/* Suggestion Menu */
#suggestionMenu {
    position: absolute;
    background: var(--bg-surface);
    border-radius: var(--radius);
    box-shadow: var(--shadow-lg);
    display: none;
    flex-direction: column;
    z-index: 1000;
    overflow: hidden;
    min-width: 250px;
    max-width: 350px;
    max-height: 350px;
    overflow-y: auto;
    border: 1px solid var(--border-light);
    animation: slideIn 0.2s ease-out;
}

@keyframes slideIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}

.suggestion-header {
    padding: 12px 15px;
    background: var(--gradient);
    color: white;
    font-weight: 600;
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: sticky;
    top: 0;
    font-size: 0.9rem;
}

.suggestion-item {
    padding: 12px 15px;
    cursor: pointer;
    font-size: 16px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    transition: all 0.2s ease;
    font-family: 'Noto Sans Sinhala', sans-serif;
}

.suggestion-item:hover {
    background: rgba(67, 97, 238, 0.1);
}

.suggestion-item.active {
    background: rgba(67, 97, 238, 0.2);
    border-left: 3px solid var(--primary);
}

.suggestion-index {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    background: var(--primary);
    color: white;
    border-radius: 50%;
    margin-right: 10px;
    font-size: 0.8rem;
    font-weight: 600;
}

.suggestion-item.active .suggestion-index {
    background: var(--accent);
}

/* Features Grid */
.features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.feature-card {
    background: var(--bg-card);
    border-radius: var(--radius);
    padding: 20px;
    border: 1px solid var(--border);
    transition: all 0.3s ease;
    box-shadow: var(--shadow);
}

.feature-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-lg);
    border-color: var(--primary);
}

.feature-icon {
    width: 50px;
    height: 50px;
    background: var(--gradient);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 15px;
    font-size: 20px;
}

.feature-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 8px;
    color: var(--text-primary);
}

.feature-description {
    color: var(--text-secondary);
    line-height: 1.5;
    font-size: 0.9rem;
}

/* Progress Container */
.progress-container {
    background: var(--bg-card);
    border-radius: var(--radius);
    padding: 15px;
    margin-bottom: 20px;
    border: 1px solid var(--border);
    box-shadow: var(--shadow);
}

.progress-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 12px;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.95rem;
}

.progress-bar {
    width: 100%;
    height: 10px;
    background: var(--bg-surface);
    border-radius: 5px;
    overflow: hidden;
    margin-bottom: 8px;
}

.progress-fill {
    height: 100%;
    background: var(--gradient);
    width: 0%;
    transition: width 0.5s ease;
    border-radius: 5px;
}

.progress-info {
    display: flex;
    justify-content: space-between;
    color: var(--text-secondary);
    font-size: 0.85rem;
}

/* Shortcuts */
.shortcuts-container {
    background: var(--bg-card);
    border-radius: var(--radius);
    padding: 20px;
    margin-bottom: 30px;
    border: 1px solid var(--border);
    box-shadow: var(--shadow);
}

.shortcuts-title {
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 15px;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 8px;
}

.shortcuts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 10px;
}

.shortcut-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 10px 12px;
    background: var(--bg-surface);
    border-radius: var(--radius-sm);
    transition: all 0.2s ease;
}

.shortcut-item:hover {
    background: rgba(67, 97, 238, 0.1);
    transform: translateX(3px);
}

.shortcut-key {
    background: var(--primary);
    color: white;
    padding: 5px 10px;
    border-radius: 5px;
    font-family: monospace;
    font-weight: 600;
    min-width: 35px;
    text-align: center;
    font-size: 0.85rem;
}

.shortcut-desc {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

/* Komi Character Container */
.komi-character-container {
    background: var(--bg-card);
    border-radius: var(--radius);
    padding: 25px;
    margin-bottom: 30px;
    border: 1px solid var(--border);
    box-shadow: var(--shadow-lg);
}

.komi-wrapper {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 300px;
    margin-Top:-100px;
	margin-right:100px;
    position: relative;
}

.komi-description {
    text-align: center;
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px solid var(--border);
}

/* Komi Character Styles */
.komi {
    position: relative;
    scale: 0.8;
}

.komi *,
.komi *::before,
.komi *::after {
    position: absolute;
}

.komi-head,
.komi-body,
.komi-hair-extension {
    animation: var(--hover-animation, none);
}

.komi-eye {
    top: 4.5rem;
    right: var(--eye-right, auto);
    left: var(--eye-left, auto);
    --flip: 1;
    --eye-offset: 1.25rem;
    --pupil-offset: 0.5rem;
    --eye-line-top-offset: -13%;
    --eye-line-bottom-offset: 16%;
    z-index: 2;
    height: 3.75rem;
    width: 4rem;
    transform-origin: center 70%;
    border-radius: 100%;
    background-color: var(--komi-white);
    animation: blinky 7s infinite;
}

.komi-eye::before,
.komi-eye::after {
    content: '';
}

.komi-eye::before {
    top: -0.0625rem;
    right: var(--eye-line-top-right, auto);
    left: var(--eye-line-top-left, auto);
    height: 120%;
    width: 120%;
    transform: rotate(calc(-12deg * var(--flip)));
    border-radius: 100%;
    border: var(--komi-line-width-2) solid transparent;
    border-top: var(--komi-line-width-2) solid var(--komi-black);
}

.komi-eye::after {
    bottom: 0;
    right: var(--eye-line-bottom-right, auto);
    left: var(--eye-line-bottom-left, auto);
    height: 15%;
    width: 50%;
    transform: rotate(calc(8deg * var(--flip)));
    border-radius: 100%;
    border: var(--komi-line-width-1) solid transparent;
    border-bottom: var(--komi-line-width-1) solid var(--komi-black);
}

.komi-eye-sparkle {
    inset: 15% 20%;
    transform: scale(var(--eye-sparkle-scale, 0));
    transition: 0.4s ease-in-out;
}

.komi-eye-sparkle::before,
.komi-eye-sparkle::after {
    content: '';
    border-radius: 100%;
    background-color: var(--komi-sparkle-color);
}

.komi-eye-sparkle::before {
    left: 50%;
    height: 100%;
    width: 0.5rem;
    transform: translateX(-50%);
    animation: twinkleY 0.3s infinite;
}

.komi-eye-sparkle::after {
    top: 50%;
    width: 100%;
    height: 0.5rem;
    transform: translateY(-50%);
    animation: twinkleX 0.3s 0.3s infinite;
}

.komi-eye-pupil {
    top: 0.75rem;
    right: var(--pupil-right, auto);
    left: var(--pupil-left, auto);
    height: 2.5rem;
    width: 2.5rem;
    transform: scale(var(--eye-pupil-scale, 1));
    border-radius: 100%;
    background-color: var(--komi-black);
    transition: 0.4s ease-in-out;
    overflow: hidden;
}

.komi-eye-pupil::before {
    content: '';
    top: 60%;
    left: 50%;
    height: 100%;
    width: 130%;
    transform: translateX(-50%);
    border-radius: 100%;
    background-color: var(--komi-primary-color-tint);
}

.komi-eye-left {
    --eye-left: var(--eye-offset);
    --pupil-right: var(--pupil-offset);
    --eye-line-top-left: var(--eye-line-top-offset);
    --eye-line-bottom-left: var(--eye-line-bottom-offset);
}

.komi-eye-right {
    --flip: -1;
    --eye-right: var(--eye-offset);
    --pupil-left: var(--pupil-offset);
    --eye-line-top-right: var(--eye-line-top-offset);
    --eye-line-bottom-right: var(--eye-line-bottom-offset);
}

.komi-blush {
    top: 7.5rem;
    right: var(--blush-right, auto);
    left: var(--blush-left, auto);
    --blush-offset: 0.75rem;
    height: 2rem;
    width: 2.5rem;
    border-radius: 100%;
    background-color: var(--komi-accent-color);
    opacity: var(--blush-opacity, 0.1);
    transition: 0.8s;
}

.komi-blush-left {
    --blush-left: var(--blush-offset);
}

.komi-blush-right {
    --blush-right: var(--blush-offset);
}

.komi-ear {
    top: 5.75rem;
    right: var(--ear-right, auto);
    left: var(--ear-left, auto);
    --flip: 1;
    --ear-offset: -1.25rem;
    height: 3rem;
    width: 2rem;
    transform: rotate(calc(40deg * var(--flip)));
    border-radius: 100%;
    background-color: var(--komi-secondary-color);
}

.komi-ear-left {
    --flip: -1;
    --ear-left: var(--ear-offset);
    z-index: -1;
}

.komi-ear-right {
    --ear-right: var(--ear-offset);
}

.komi-cat-ear {
    top: var(--cat-ear-translate, 4rem);
    right: var(--cat-ear-right, auto);
    left: var(--cat-ear-left, auto);
    --flip: 1;
    --cat-ear-offset: -3rem;
    --cat-ear-fur-offset: 20%;
    --cat-ear-fur-1-offset: 1.75rem;
    --cat-ear-fur-2-offset: 1.5rem;
    z-index: -1;
    height: 6rem;
    width: 5rem;
    transition: 0.5s ease-in-out;
}

.komi-cat-ear::before {
    content: '';
    inset: 0;
    transform-origin: var(--cat-ear-transform-origin);
    transform: rotate(calc(30deg * var(--flip)));
    border-radius: inherit;
    background-color: var(--komi-primary-color);
}

.komi-cat-ear-fur {
    top: 10%;
    right: var(--cat-ear-fur-right, auto);
    left: var(--cat-ear-fur-left, auto);
    height: 70%;
    width: 70%;
    transform-origin: var(--cat-ear-transform-origin);
    transform: rotate(calc(30deg * var(--flip)));
    border-radius: inherit;
    background-color: var(--komi-primary-color-tint);
}

.komi-cat-ear-fur::before,
.komi-cat-ear-fur::after {
    content: '';
    border-radius: var(--cat-ear-fur-border-radius);
    background-color: var(--komi-primary-color);
}

.komi-cat-ear-fur::before {
    top: -0.625rem;
    right: var(--cat-ear-fur-1-right, auto);
    left: var(--cat-ear-fur-1-left, auto);
    height: 2rem;
    width: 2rem;
    transform: rotate(calc(-70deg * var(--flip)));
}

.komi-cat-ear-fur::after {
    top: -0.25rem;
    right: var(--cat-ear-fur-2-right, auto);
    left: var(--cat-ear-fur-2-left, auto);
    height: 1rem;
    width: 1rem;
    transform: rotate(calc(-50deg * var(--flip)));
}

.komi-cat-ear-left {
    --cat-ear-left: var(--cat-ear-offset);
    --cat-ear-transform-origin: right bottom;
    --cat-ear-fur-left: var(--cat-ear-fur-offset);
    --cat-ear-fur-1-left: var(--cat-ear-fur-1-offset);
    --cat-ear-fur-2-left: var(--cat-ear-fur-2-offset);
    --cat-ear-fur-border-radius: 0 100% 0 100%;
    border-radius: 0.5rem 0 0 100%;
}

.komi-cat-ear-right {
    --flip: -1;
    --cat-ear-right: var(--cat-ear-offset);
    --cat-ear-transform-origin: left bottom;
    --cat-ear-fur-right: var(--cat-ear-fur-offset);
    --cat-ear-fur-1-right: var(--cat-ear-fur-1-offset);
    --cat-ear-fur-2-right: var(--cat-ear-fur-2-offset);
    --cat-ear-fur-border-radius: 100% 0 100% 0;
    border-radius: 0 0.5rem 100% 0;
    animation: var(--cat-ear-animation);
}

.komi-face {
    border-radius: 50% 50% 50% 40%;
    inset: 0;
    background-color: var(--komi-secondary-color);
}

.komi-face-inner {
    inset: 0;
}

.komi-hair-back {
    top: -2.75rem;
    left: -2rem;
    width: 120%;
}

.komi-hair-back-1 {
    width: 100%;
    height: 9.5rem;
    transform: rotate(-10deg);
    border-radius: 100%;
    background-color: var(--komi-primary-color);
}

.komi-hair-back-1::before,
.komi-hair-back-1::after {
    content: '';
}

.komi-hair-back-1::before {
    top: 5.5rem;
    right: -1rem;
    width: 50%;
    height: 60%;
    background-color: inherit;
    border-radius: 100%;
}

.komi-hair-back-1::after {
    inset: 0;
    border-radius: inherit;
    border-left: 1rem solid var(--komi-primary-color-tint);
}

.komi-hair-bangs {
    top: -0.5rem;
    left: 25%;
    width: 65%;
}

.komi-hair-bangs::before,
.komi-hair-bangs::after {
    content: '';
    z-index: 2;
    background-color: var(--komi-primary-color-tint);
}

.komi-hair-bangs::before {
    top: 2.5rem;
    left: -3.75rem;
    height: 1rem; 
    width: 1rem;
    transform: rotate(-2deg) skewY(20deg);
    border-radius: 0.25rem;
}

.komi-hair-bangs::after {
    top: 2.25rem;
    left: 0.5rem;
    height: 1rem; 
    width: 90%;
    transform: rotate(-2deg) skewY(10deg);
    border-radius: 0.25rem;
}

.komi-hair-bangs-1,
.komi-hair-bangs-2 {
    transform-origin: center top;
    background-color: var(--komi-primary-color);
}

.komi-hair-bangs-1 {
    top: 0;
    left: 0;
    width: 55%;
    height: 6rem;
    transform: rotate(-8deg);
    border-bottom-left-radius: 100% 50%;
}

.komi-hair-bangs-1::before {
    content: '';
    left: -1.5rem;
    height: 80%;
    width: 3rem;
    border-bottom-left-radius: 100%;
    transform: rotate(50deg);
    border-left: 1.5rem solid var(--komi-primary-color);
}

.komi-hair-bangs-2 {
    top: 0;
    left: 50%;
    width: 45%;
    height: 6.5rem;
    transform: rotate(-12deg);
    border-bottom-left-radius: 100% 70%;
}

.komi-hair-bangs-3 {
    top: 1.5rem;
    left: -1.75rem;
    height: 6rem;
    width: 4.5rem;
    border-bottom-left-radius: 100%;
    transform-origin: center top;
    transform: rotate(45deg);
    border-left: 1.75rem solid var(--komi-primary-color);
}

.komi-hair-strand {
    z-index: -1;
    top: 4rem;
    left: -0.75rem;
    height: 13rem;
    width: 1.5rem;
    background-color: var(--komi-primary-color);
}

.komi-head {
    position: relative;
    z-index: 3;
    height: 12rem;
    width: 13rem;
    margin-bottom: 5rem;
}

.komi-hair-extension {
    top: 3rem;
    left: calc(50% - 7rem);
    width: 14rem;
    height: 14rem;
    background-color: var(--komi-primary-color);
}

.komi-hair-extension::after {
    content: '';
    left: 1rem;
    height: 100%;
    width: 5rem;
    background-color: var(--komi-primary-color-dark);
}

.komi-neck {
    z-index: 2;
    bottom: calc(100% - 0.25rem);
    left: 50%;
    height: 5rem;
    width: 2rem;
    transform: translateX(-50%);
    background-color: var(--komi-secondary-color);
}

.komi-neck::after {
    content: '';
    z-index: -1;
    top: calc(100% - 0.125rem);
    left: 50%;
    border: 1.125rem solid transparent;
    border-top-color: var(--komi-secondary-color);
    transform: translateX(-50%);
}

.komi-neck-shadow {
    inset: 0;
    overflow: hidden;
}

.komi-neck-shadow::before {
    content: '';
    top: 0.25rem;
    left: 50%;
    width: 250%;
    height: 3rem;
    border-radius: 100%;
    background-color: var(--komi-black);
    transform: translateX(-50%);
    opacity: 0.1;
}

.komi-collar {
    --flip: 1;
    --collar-offset: -4.4375rem;
    bottom: -0.5rem;
    left: 50%;
    height: 3rem;
    width: 100%;
    transform: translateX(-50%) skewY(calc(-15deg * var(--flip))) scaleY(0.6);
}

.komi-collar::before {
    content: '';
    top: 0.5rem;
    right: var(--collar-right, auto);
    left: var(--collar-left, auto);
    height: 0;
    width: 0;
    border: 2.5rem solid transparent;
    border-top-color: var(--komi-shirt-color);
    transform: rotate(calc(78deg * var(--flip)));
}

.komi-collar-left {
    --collar-left: var(--collar-offset);
}

.komi-collar-right {
    --flip: -1;
    --collar-right: var(--collar-offset);
}

.komi-bow {
    bottom: -1.875rem;
    left: 50%;
    height: 0.75rem;
    width: 1.25rem;
    transform: translateX(-50%);
}

.komi-bow::after {
    content: '';
    z-index: 3;
    inset: 0;
    border-radius: 0.75rem;
    background-color: var(--komi-bow-color-1);
    background-image: var(--komi-bow-gradient);
}

.komi-bow-top {
    --flip: 1;
    --bow-top-offset: 0.75rem;
    z-index: 2;
    inset: 0;
}

.komi-bow-top::before,
.komi-bow-top::after {
    content: '';
    top: -0.25rem;
    right: var(--bow-top-right, auto);
    left: var(--bow-top-left, auto);
    height: 1.75rem;
    width: 1.75rem;
    transform: rotate(calc(-15deg * var(--flip))) perspective(1rem) rotateY(calc(22deg * var(--flip)));
    background-color: var(--komi-bow-color-1);
    background-image: var(--komi-bow-gradient);
    border-radius: 0.25rem;
}

.komi-bow-top::before {
    --bow-top-right: var(--bow-top-offset);
}

.komi-bow-top::after {
    --bow-top-left: var(--bow-top-offset);
    --flip: -1;
}

.komi-bow-top-shadow {
    --bow-top-shadow-offset: 0.75rem;
    inset: 0;
}

.komi-bow-top-shadow::before,
.komi-bow-top-shadow::after {
    content: '';
    z-index: 1;
    top: 0.125rem;
    right: var(--bow-top-shadow-right, auto);
    left: var(--bow-top-shadow-left, auto);
    height: 0.75rem;
    width: 1.25rem;
    transform: rotate(calc(-15deg * var(--flip)));
    border-radius: 100%;
    background-color: var(--komi-bow-color-2);
    mix-blend-mode: multiply;
    opacity: 0.4;
}

.komi-bow-top-shadow::before {
    --bow-top-shadow-right: var(--bow-top-shadow-offset);
}

.komi-bow-top-shadow::after {
    --bow-top-shadow-left: var(--bow-top-shadow-offset);
    --flip: -1;
}

.komi-bow-bottom {
    --flip: 1;
    --bow-bottom-offset: -1.5rem;
    z-index: 1;
    inset: 0;
}

.komi-bow-bottom::before,
.komi-bow-bottom::after {
    content: '';
    top: 0.325rem;
    right: var(--bow-bottom-right, auto);
    left: var(--bow-bottom-left, auto);
    height: 1.75rem;
    width: 2rem;
    transform: rotate(calc(15deg * var(--flip)));
    border-radius: 0.125rem;
    background-color: var(--komi-bow-color-1);
    background-image: var(--komi-bow-gradient);
}

.komi-bow-bottom::before {
    --bow-bottom-left: var(--bow-bottom-offset);
}

.komi-bow-bottom::after {
    --bow-bottom-right: var(--bow-bottom-offset);
    --flip: -1;
}

.komi-shirt {
    --flip: 1;
    z-index: 1;
    top: -0.5rem;
    left: 50%;
    width: 9rem;
    height: 8rem;
    transform: translateX(-50%);
}

.komi-shirt::before,
.komi-shirt::after {
    content: '';
    z-index: 2;
    top: 0;
    right: var(--shirt-right, auto);
    left: var(--shirt-left, auto);
    height: 100%;
    width: 70%;
    border-radius: 0.5rem;
    background-color: var(--komi-shirt-color-dark);
    transform: rotate(calc(8deg * var(--flip)));
}

.komi-shirt::before {
    --shirt-left: 0;
    --flip: -1;
}

.komi-shirt::after {
    --shirt-right: 0;
}

.komi-shirt-sleeves::before,
.komi-shirt-sleeves::after {
    content: '';
    z-index: -1;
    top: 1rem;
    right: var(--shirt-sleeve-right, auto);
    left: var(--shirt-sleeve-left, auto);
    height: 4rem;
    width: 4rem;
    border-radius: 0.25rem;
    background-color: var(--komi-shirt-color-dark);
    transform: rotate(calc(20deg * var(--flip)));
}

.komi-shirt-sleeves::before {
    --shirt-sleeve-left: -1.25rem;
}

.komi-shirt-sleeves::after {
    --shirt-sleeve-right: -1.25rem;
    --flip: -1;
}

.komi-shirt-sleeves,
.komi-shirt-sleeves-shadow {
    inset: 0;
}

.komi-shirt-sleeves-shadow {
    z-index: 1;
}

.komi-shirt-sleeves-shadow::before,
.komi-shirt-sleeves-shadow::after {
    content: '';
    top: 2.5rem;
    right: var(--shirt-sleeve-sh-right, auto);
    left: var(--shirt-sleeve-sh-left, auto);
    height: 50%;
    width: 1.5rem;
    transform: rotate(calc(20deg * var(--flip)));
    background-color: var(--komi-shirt-color-dark-2);
}

.komi-shirt-sleeves-shadow::before {
    --shirt-sleeve-sh-left: -1rem;
}

.komi-shirt-sleeves-shadow::after {
    --shirt-sleeve-sh-right: -1rem;
    --flip: -1;
}

.komi-body {
    z-index: 1;
    top: 12rem;
    left: calc(50% - 6rem);
    height: 6rem;
    width: 12rem;
}

.komi-panel {
    top: 2rem;
    left: 50%;
    width: 14rem;
    height: 15rem;
    transform: translateX(-50%);
    background-color: var(--komi-white);
    overflow: hidden;
}

.komi-zigzag {
    background-image: repeating-linear-gradient(45deg, var(--komi-primary-color-tint) 0 0.125rem, transparent 0.125rem 0.25rem);
    opacity: var(--zigzag-opacity, 0);
    transition: 0.3s;
}

.komi-zigzag,
.komi-zigzag::after {
    height: 0.125rem;
    width: 1.125rem;
}

.komi-zigzag::after {
    content: '';
    background-image: repeating-linear-gradient(-45deg, transparent 0 0.125rem, var(--komi-primary-color-tint) 0.125rem 0.25rem);
}

.komi-zigzag-1 {
    left: -2rem;
    bottom: 2rem;
    transform: rotate(85deg);
}

.komi-zigzag-2 {
    left: -2rem;
    bottom: 6rem;
    width: 0.875rem;
    transform: rotate(90deg);
}

.komi-zigzag-3 {
    left: -3rem;
    top: 5rem;
    transform: rotate(60deg);
}

.komi-zigzag-4 {
    left: -2rem;
    top: -1rem;
    transform: rotate(-40deg);
}

.komi-zigzag-5 {
    left: 5rem;
    top: -4rem;
    transform: rotate(-10deg);
}

.komi-zigzag-6 {
    right: -1rem;
    top: -2rem;
    transform: rotate(50deg);
}

.komi-zigzag-7 {
    right: -3.5rem;
    top: 4rem;
    transform: rotate(80deg);
}

.komi-zigzag-8 {
    right: -2.5rem;
    top: 8rem;
    width: 0.875rem;
    transform: rotate(-60deg);
}

.komi-zigzag-9 {
    right: -2rem;
    bottom: 5rem;
    transform: rotate(90deg);
}

.komi-zigzag-10 {
    right: -2rem;
    bottom: 1rem;
    transform: rotate(95deg);
}

.komi-buruburu {
    right: -3rem;
    top: 0;
    height: 100%;
    transform-origin: center bottom;
    transform: rotate(5deg) skewX(-10deg) scale(var(--buruburu-scale, 0.7));
    font-size: 3rem;
    color: var(--komi-primary-color);
    opacity: var(--buruburu-opacity, 0);
    transition: opacity 0.3s, transform 0.4s ease-in-out;
    font-family: 'Kiwi Maru', serif;
}

.komi-buruburu-character {
    position: absolute;
}

.komi-buruburu-character-1 {
    left: -0.25em;
    font-size: 1.2em;
}

.komi-buruburu-character-2 {
    top: 1.0625em;
    left: -0.125em;
}

.komi-buruburu-character-3 {
    top: 2em;
    left: -0.5em;
}

.komi-buruburu-character-4 {
    top: 3.25em;
    left: -0.625em;
    font-size: 0.9em;
}

.komi-buruburu-character-5 {
    top: 4.75em;
    left: -0.75em;
    font-size: 0.8em;
}

.komi-buruburu-character-6 {
    top: 6.5em;
    left: -0.5em;
    font-size: 0.7em;
}

.komi:hover {
    --hover-animation: tremble 0.3s infinite;
    --eye-pupil-scale: 0.85;
    --zigzag-opacity: 1;
    --buruburu-opacity: 1;
    --buruburu-scale: 1;
}

.komi-head:hover {
    --eye-pupil-scale: 1.1;
    --eye-sparkle-scale: 1;
    --blush-opacity: 0.3;
    --cat-ear-scale: 1;
    --cat-ear-translate: -3rem;
    --cat-ear-animation: catEarTwitch 3s 0.5s infinite;
}

.komi-head:hover,
.komi-head:hover + .komi-panel {
    --hover-animation: none;
}

.komi-head:hover ~ .komi-zigzag {
    --zigzag-opacity: 0;
}

.komi-head:hover ~ .komi-buruburu {
    --buruburu-opacity: 0;
}

@keyframes twinkleY {
    0%, 100% {
        transform: translateX(-50%) scaleY(1);
    }
    
    50% {
        transform: translateX(-50%) scaleY(0.5);
    }
}

@keyframes twinkleX {
    0%, 100% {
        transform: translateY(-50%) scaleX(1);
    }
    
    50% {
        transform: translateY(-50%) scaleX(0.5);
    }
}

@keyframes catEarTwitch {
    0%, 70%, 90% {
        transform: rotate(0deg);
    }

    80%, 95% {
        transform: rotate(5deg) scaleX(0.9);
    }
}

@keyframes tremble {
    0%, 24%, 50%, 74%, 100% {
        transform: translate(0, 0);
    }

    25%, 49% {
        transform: translate(0.0625rem, 0.1875rem);
    }

    75%, 99% {
        transform: translate(-0.0625rem, 0.1875rem);
    }
}

@keyframes blinky {
    0%, 45%, 55%, 100% { transform: scaleY(1); }
    50% { transform: scaleY(0.1); }
}

/* Example Type Selection */
.example-type-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
    margin-bottom: 25px;
}

.example-type-card {
    background: var(--bg-card);
    border-radius: var(--radius);
    padding: 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    border: 1px solid var(--border);
}

.example-type-card:hover {
    transform: translateY(-5px);
    border-color: var(--primary);
    box-shadow: var(--shadow);
}

.example-type-card.active {
    background: var(--gradient);
    border-color: var(--primary);
}

.example-type-card.active .example-type-title {
    color: white;
}

.example-type-card.active .example-type-desc {
    color: rgba(255, 255, 255, 0.8);
}

.example-type-icon {
    font-size: 30px;
    margin-bottom: 10px;
    color: var(--primary);
}

.example-type-card.active .example-type-icon {
    color: white;
}

.example-type-title {
    font-weight: 600;
    margin-bottom: 5px;
    color: var(--text-primary);
}

.example-type-desc {
    color: var(--text-secondary);
    font-size: 0.8rem;
}

/* Footer */
.footer {
    text-align: center;
    padding: 25px 0;
    color: var(--text-muted);
    font-size: 0.85rem;
    border-top: 1px solid var(--border);
    margin-top: 30px;
}

.footer-links {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 12px;
    flex-wrap: wrap;
}

.footer-link {
    color: var(--text-secondary);
    text-decoration: none;
    transition: color 0.2s ease;
    font-size: 0.85rem;
}

.footer-link:hover {
    color: var(--primary);
}

/* Notification */
.notification {
    position: fixed;
    top: 20px;
    right: 20px;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 12px 16px;
    box-shadow: var(--shadow-lg);
    display: none;
    align-items: center;
    gap: 12px;
    z-index: 1001;
    animation: slideInRight 0.3s ease;
    max-width: 350px;
}

@keyframes slideInRight {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

.notification-icon {
    width: 35px;
    height: 35px;
    border-radius: 50%;
    background: var(--gradient);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
}

.notification-content {
    flex: 1;
}

.notification-title {
    font-weight: 600;
    margin-bottom: 3px;
    font-size: 0.9rem;
}

.notification-message {
    color: var(--text-secondary);
    font-size: 0.85rem;
}

.notification-close {
    background: none;
    border: none;
    color: var(--text-muted);
    cursor: pointer;
    font-size: 16px;
}

/* Responsive */
@media (max-width: 768px) {
    .header {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .stats-container {
        width: 100%;
        justify-content: space-between;
    }
    
    .stat-box {
        min-width: calc(50% - 10px);
    }
    
    .editor-container {
        padding: 20px;
    }
    
    #editor {
        font-size: 16px;
        min-height: 250px;
    }
    
    .features-grid {
        grid-template-columns: 1fr;
    }
    
    .title-container h1 {
        font-size: 1.8rem;
    }
    
    .editor-header {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .editor-actions {
        width: 100%;
    }
    
    .btn {
        flex: 1;
        justify-content: center;
        font-size: 0.85rem;
        padding: 6px 12px;
    }
    
    .anime-assistant {
        width: 80px;
        height: 100px;
        bottom: 20px;
        right: 20px;
    }
    
    .anime-body {
        width: 70px;
        height: 90px;
    }
    
    .komi {
        scale: 0.6;
    }
    
    .komi-panel {
        width: 18rem;
    }
}

@media (max-width: 480px) {
    .container {
        padding: 0 10px;
    }
    
    .stat-box {
        min-width: 100%;
    }
    
    .btn {
        width: 100%;
    }
    
    .shortcuts-grid {
        grid-template-columns: 1fr;
    }
    
    .title-container h1 {
        font-size: 1.5rem;
    }
    
    .anime-assistant {
        display: none;
    }
    
    .komi {
        scale: 0.5;
    }
    
    .example-type-container {
        grid-template-columns: repeat(2, 1fr);
    }
}
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo-container">
                <div class="logo">සි</div>
                <div class="title-container">
                    <h1>සිරි සිංහල ප්‍රෝ</h1>
                    <div class="subtitle">AI-powered Sinhala Writing Assistant</div>
                </div>
            </div>
            
            <div class="stats-container">
                <div class="stat-box">
                    <span class="stat-label">සුදුසුකම්</span>
                    <span class="stat-value" id="statusText">සුසරණය</span>
                </div>
                <div class="stat-box">
                    <span class="stat-label">වචන</span>
                    <span class="stat-value" id="wordCount">0</span>
                </div>
                <div class="stat-box">
                    <span class="stat-label">ලිපි</span>
                    <span class="stat-value" id="charCount">0</span>
                </div>
            </div>
        </div>
        
        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-title">
                <i class="fas fa-chart-line"></i> ඔබගේ ලිවීමේ ප්‍රගතිය
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-info">
                <span id="progressText">ආරම්භකයා</span>
                <span id="progressPercent">0%</span>
            </div>
        </div>

        <!-- Example Type Selection -->
        <div class="example-type-container" id="exampleTypeContainer">
            <div class="example-type-card" data-type="basic">
                <div class="example-type-icon">
                    <i class="fas fa-star"></i>
                </div>
                <div class="example-type-title">මූලික</div>
                <div class="example-type-desc">සරල වාක්‍ය</div>
            </div>
            <div class="example-type-card" data-type="conversation">
                <div class="example-type-icon">
                    <i class="fas fa-comments"></i>
                </div>
                <div class="example-type-title">සංවාද</div>
                <div class="example-type-desc">කතාබහ</div>
            </div>
            <div class="example-type-card" data-type="story">
                <div class="example-type-icon">
                    <i class="fas fa-book"></i>
                </div>
                <div class="example-type-title">කතාව</div>
                <div class="example-type-desc">කෙටි කතා</div>
            </div>
            <div class="example-type-card" data-type="formal">
                <div class="example-type-icon">
                    <i class="fas fa-file-alt"></i>
                </div>
                <div class="example-type-title">විධිමත්</div>
                <div class="example-type-desc">ලිපි/ඡේද</div>
            </div>
            <div class="example-type-card" data-type="guide">
                <div class="example-type-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="example-type-title">ස්වයං උපදේශක</div>
                <div class="example-type-desc">සජීවී උපදෙස්</div>
            </div>
        </div>
        
        <!-- Main Editor -->
        <div class="editor-container">
            <div class="editor-header">
                <div class="editor-title">
                    <i class="fas fa-edit"></i> සිංහල ලිපි සංස්කාරකය
                </div>
                <div class="editor-actions">
                    <button class="btn btn-secondary" id="tutorialBtn">
                        <i class="fas fa-graduation-cap"></i> උපදේශනය
                    </button>
                    <button class="btn btn-secondary" id="clearBtn">
                        <i class="fas fa-eraser"></i> හිස් කරන්න
                    </button>
                    <button class="btn btn-primary" id="demoBtn">
                        <i class="fas fa-magic"></i> උදාහරණය
                    </button>
                </div>
            </div>
            
            <textarea id="editor" placeholder="Singlish (ඉංග්‍රීසි අකුරින්) ඇතුල් කරන්න... මම ඔබ වෙනුවෙන් සිංහලට හැරවීමට සූදානම්!"></textarea>
            
            <!-- Auto Complete Guide -->
            <div class="auto-guide" id="autoGuide">
                <div class="guide-header">
                    <div class="guide-title">
                        <i class="fas fa-robot"></i> ස්වයං උපදේශකයා
                    </div>
                    <button class="guide-close" id="guideClose">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="guide-content" id="guideContent">
                    මම ඔබට ටයිප් කිරීමේදී උපදෙස් දෙන්නෙමි. වචන අර්ථ දැක්වීම් සහ ව්‍යාකරණ උපදෙස් ලබා ගැනීමට ටයිප් කරන්න...
                </div>
            </div>
            
            <div class="editor-footer">
                <div>
                    <span id="currentWord">වර්තමාන වචනය: </span>
                </div>
                <div>
                    <i class="fas fa-lightbulb"></i> <span id="suggestionCount">0</span> අනුමැතියන්
                </div>
                <div>
                    <i class="fas fa-history"></i> යාවත්කාලීනය: <span id="lastUpdate">-</span>
                </div>
            </div>
        </div>
        
        <!-- Suggestion Menu -->
        <div id="suggestionMenu">
            <div class="suggestion-header">
                <span>අනුමැතියන්</span>
                <span id="menuCount">0</span>
            </div>
            <!-- Suggestions will be dynamically added here -->
        </div>
        
        <!-- Features Grid -->
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-bolt"></i>
                </div>
                <h3 class="feature-title">ස්වයංක්‍රීය පරිවර්තනය</h3>
                <p class="feature-description">
                    ඔබ ටයිප් කරන විට ක්ෂණිකව Singlish සිංහලට හරවයි. වචන මඟ අරුත් ලබා දෙන AI සහායකයා.
                </p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-brain"></i>
                </div>
                <h3 class="feature-title">AI උපදේශකයා</h3>
                <p class="feature-description">
                    වචන අර්ථ, ව්‍යාකරණ උපදෙස් සහ ලේඛන සටහන් සපයයි. සෑම පියවරකදීම උපකාර කරයි.
                </p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-keyboard"></i>
                </div>
                <h3 class="feature-title">කෙටිමං සහාය</h3>
                <p class="feature-description">
                    ඉක්මන් ටයිප් කිරීම සඳහා කෙටිමං යතුරු. අනුමැතියන් තෝරා ගැනීමට අංක සහ arrow keys.
                </p>
            </div>
        </div>
        
        <!-- Shortcuts Section -->
        <div class="shortcuts-container">
            <h3 class="shortcuts-title">
                <i class="fas fa-hat-wizard"></i> කෙටිමං යතුරු
            </h3>
            <div class="shortcuts-grid">
                <div class="shortcut-item">
                    <div class="shortcut-key">Tab</div>
                    <div class="shortcut-desc">පළමු අනුමැතිය තෝරන්න</div>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-key">Enter</div>
                    <div class="shortcut-desc">අනුමැතිය තහවුරු කරන්න</div>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-key">↑ ↓</div>
                    <div class="shortcut-desc">අනුමැතියන් අතර ගමන් කරන්න</div>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-key">1-9</div>
                    <div class="shortcut-desc">අනුමැතිය සෘජුවම තෝරන්න</div>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-key">ESC</div>
                    <div class="shortcut-desc">අනුමැති මෙනුව වසන්න</div>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-key">Ctrl+G</div>
                    <div class="shortcut-desc">ස්වයං උපදේශකයා</div>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-key">Ctrl+T</div>
                    <div class="shortcut-desc">උපදේශනය ආරම්භ කරන්න</div>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-key">Ctrl+1</div>
                    <div class="shortcut-desc">මූලික උදාහරණය</div>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-key">Ctrl+2</div>
                    <div class="shortcut-desc">සංවාද උදාහරණය</div>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-key">Ctrl+3</div>
                    <div class="shortcut-desc">කතාව උදාහරණය</div>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-key">Ctrl+4</div>
                    <div class="shortcut-desc">විධිමත් උදාහරණය</div>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-key">Ctrl+5</div>
                    <div class="shortcut-desc">ස්වයං උපදේශකයා</div>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-key">Ctrl+S</div>
                    <div class="shortcut-desc">පාඨය සුරකින්න</div>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-key">Ctrl+C</div>
                    <div class="shortcut-desc">හිස් කරන්න</div>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-key">Ctrl+D</div>
                    <div class="shortcut-desc">උදාහරණය පූරණය කරන්න</div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <div class="footer">
            <p>සිරි සිංහල ප්‍රෝ &copy; 2025 - සියලුම හිමිකම් ඇවිරිණි</p>
            <div class="footer-links">
                <a href="https://t.me/mataberiyo" class="footer-link" id="helpLink">සහාය</a>
                <a href="#" class="footer-link">අප ගැන</a>
                <a href="#" class="footer-link">රහස්‍යතා ප්‍රතිපත්තිය</a>
                <a href="#" class="footer-link">සම්බන්ධ වන්න</a>
            </div>
        </div>
    </div>
	
<script>

// DOM Elements - The existing ones you have plus the new helpLink
const helpLink = document.getElementById('helpLink');
const aboutLink = document.querySelector('a[href="#"]:nth-child(2)');
const privacyLink = document.querySelector('a[href="#"]:nth-child(3)');
const contactLink = document.querySelector('a[href="#"]:nth-child(4)');

// Telegram profile information - Edit these details
const telegramProfile = {
    name: "KUDDA",
    username: "mataberiyo",
    description: "සිරි සිංහල ප්‍රෝ වල නිර්මාතෘ. ඔබගේ සිංහල ලිවීමේ අත්දැකීම් වැඩිදියුණු කිරීමට මම මෙහි සිටිමි.",
    imageUrl: "https://raw.githubusercontent.com/PKFireBaron/Chibi/master/chibi.png" // Replace with actual image URL
};

// Function to open centered popup window
function openCenteredPopup(content, width, height, title) {
    // Calculate center position for the popup window
    const left = (screen.width / 2) - (width / 2);
    const top = (screen.height / 2) - (height / 2);
    
    // Create window features string with centered position
    const windowFeatures = `width=${width},height=${height},left=${left},top=${top},menubar=no,toolbar=no,location=no,status=no`;
    
    // Open the popup window
    const popupWindow = window.open('', '_blank', windowFeatures);
    
    if (popupWindow) {
        popupWindow.document.write(content);
        popupWindow.document.title = title;
        popupWindow.document.close();
        
        // Focus on the new window
        popupWindow.focus();
    }
    
    return popupWindow;
}

// Function to create Telegram profile popup (සහාය)
helpLink.addEventListener('click', function(e) {
    e.preventDefault();
    
    const popupContent = `
        <!DOCTYPE html>
        <html lang="si">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Telegram Profile | ${telegramProfile.name}</title>
            <style>
                * { margin: 0; padding: 0; box-sizing: border-box; }
                body {
                    background: linear-gradient(135deg, #0a0a0f, #141420);
                    color: white;
                    font-family: 'Noto Sans Sinhala', 'Inter', sans-serif;
                    min-height: 100vh;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    padding: 20px;
                }
                .telegram-profile {
                    background: rgba(30, 30, 45, 0.9);
                    border-radius: 20px;
                    padding: 30px;
                    width: 100%;
                    max-width: 400px;
                    box-shadow: 0 15px 40px rgba(0,0,0,0.5);
                    border: 2px solid #0088cc;
                    text-align: center;
                }
                .profile-image {
                    width: 120px;
                    height: 120px;
                    border-radius: 50%;
                    border: 4px solid #0088cc;
                    margin: 0 auto 20px;
                    background-color: #1e1e2d;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    font-size: 40px;
                    color: #0088cc;
                    overflow: hidden;
                }
                .profile-image img {
                    width: 100%;
                    height: 100%;
                    object-fit: cover;
                }
                .profile-name {
                    font-size: 28px;
                    color: white;
                    margin-bottom: 5px;
                }
                .profile-username {
                    color: #0088cc;
                    font-size: 16px;
                    margin-bottom: 20px;
                }
                .profile-description {
                    color: #b0b0c0;
                    line-height: 1.5;
                    margin-bottom: 30px;
                    font-size: 15px;
                }
                .telegram-button {
                    background: #0088cc;
                    color: white;
                    border: none;
                    padding: 12px 30px;
                    border-radius: 25px;
                    font-size: 16px;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    text-decoration: none;
                    display: inline-block;
                    font-family: 'Noto Sans Sinhala', sans-serif;
                }
                .telegram-button:hover {
                    background: #0077b3;
                    transform: translateY(-2px);
                }
                .close-button {
                    background: rgba(255,255,255,0.1);
                    color: white;
                    border: 1px solid rgba(255,255,255,0.2);
                    padding: 8px 20px;
                    border-radius: 20px;
                    margin-top: 15px;
                    cursor: pointer;
                    font-size: 14px;
                }
            </style>
            <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Sinhala:wght@400;500;600;700&display=swap" rel="stylesheet">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        </head>
        <body>
            <div class="telegram-profile">
                <div class="profile-image">
                    <img src="${telegramProfile.imageUrl}" alt="${telegramProfile.name}" onerror="this.src='https://cdn-icons-png.flaticon.com/512/2111/2111646.png'; this.alt='Default Telegram Logo'; this.style.padding='20px';">
                </div>
                <h2 class="profile-name">${telegramProfile.name}</h2>
                <p class="profile-username">@${telegramProfile.username}</p>
                <p class="profile-description">${telegramProfile.description}</p>
                <a href="https://t.me/${telegramProfile.username}" target="_blank" class="telegram-button">
                    <i class="fab fa-telegram"></i> Telegram විවෘත කරන්න
                </a>
                <br>
                <button class="close-button" onclick="window.close()">වසන්න</button>
            </div>
        </body>
        </html>
    `;
    
    openCenteredPopup(popupContent, 450, 600, `Telegram Profile | ${telegramProfile.name}`);
});

// Function to create About page (අප ගැන)
aboutLink.addEventListener('click', function(e) {
    e.preventDefault();
    
    const popupContent = `
        <!DOCTYPE html>
        <html lang="si">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>අප ගැන | සිරි සිංහල ප්‍රෝ</title>
            <style>
                * { margin: 0; padding: 0; box-sizing: border-box; }
                body {
                    background: linear-gradient(135deg, #0a0a0f, #1a1a2e);
                    color: white;
                    font-family: 'Noto Sans Sinhala', 'Inter', sans-serif;
                    min-height: 100vh;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    padding: 20px;
                }
                .about-container {
                    background: rgba(30, 30, 45, 0.9);
                    border-radius: 20px;
                    padding: 35px;
                    width: 100%;
                    max-width: 500px;
                    box-shadow: 0 15px 40px rgba(0,0,0,0.5);
                    border: 2px solid #4361ee;
                }
                .about-title {
                    text-align: center;
                    font-size: 32px;
                    background: linear-gradient(135deg, #4361ee, #f72585);
                    -webkit-background-clip: text;
                    background-clip: text;
                    color: transparent;
                    margin-bottom: 25px;
                }
                .about-content {
                    color: #b0b0c0;
                    line-height: 1.7;
                    margin-bottom: 25px;
                    font-size: 16px;
                }
                .feature-list {
                    margin: 20px 0;
                    padding-left: 20px;
                }
                .feature-list li {
                    margin-bottom: 10px;
                    color: #4cc9f0;
                }
                .about-button {
                    background: linear-gradient(135deg, #4361ee, #7209b7);
                    color: white;
                    border: none;
                    padding: 12px 30px;
                    border-radius: 25px;
                    font-size: 16px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    display: block;
                    margin: 30px auto 0;
                    font-family: 'Noto Sans Sinhala', sans-serif;
                }
                .about-button:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 10px 25px rgba(67, 97, 238, 0.4);
                }
            </style>
            <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Sinhala:wght@400;500;600;700&display=swap" rel="stylesheet">
        </head>
        <body>
            <div class="about-container">
                <h1 class="about-title">අප ගැන</h1>
                <div class="about-content">
                    <p>සිරි සිංහල ප්‍රෝ යනු සිංහල භාෂාවේ ලිවීමේ හැකියාවන් වැඩිදියුණු කිරීම සඳහා නිර්මාණය කරන ලද AI-පාදක ලේඛන සහායකයකි.</p>
                    
                    <p>අපගේ අරමුණ:</p>
                    <ul class="feature-list">
                        <li>Singlish සිංහල අක්ෂරවලට ක්ෂණිකව පරිවර්තනය කිරීම</li>
                        <li>ව්‍යාකරණ හා අක්ෂර වින්‍යාසය පිළිබඳ බුද්ධිමත් උපදෙස්</li>
                        <li>අර්ථ සහ වාක්‍ය ගොඩනැගීම සඳහා AI උපදේශකයා</li>
                        <li>සිංහල භාෂාව ඉගෙන ගන්නන් සහ වෘත්තීය ලේඛකයින් සඳහා සරල අතුරුමුහුණත</li>
                    </ul>
                    
                    <p>සිරි සිංහල ප්‍රෝ නිර්මාණය කර ඇත්තේ KUDDA විසිනි.</p>
                </div>
                <button class="about-button" onclick="window.close()">වසන්න</button>
            </div>
        </body>
        </html>
    `;
    
    openCenteredPopup(popupContent, 550, 700, 'අප ගැන | සිරි සිංහල ප්‍රෝ');
});

// Function to create Privacy Policy page (රහස්‍යතා ප්‍රතිපත්තිය)
privacyLink.addEventListener('click', function(e) {
    e.preventDefault();
    
    const popupContent = `
        <!DOCTYPE html>
        <html lang="si">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>රහස්‍යතා ප්‍රතිපත්තිය | සිරි සිංහල ප්‍රෝ</title>
            <style>
                * { margin: 0; padding: 0; box-sizing: border-box; }
                body {
                    background: linear-gradient(135deg, #0a0a0f, #1a1a2e);
                    color: white;
                    font-family: 'Noto Sans Sinhala', 'Inter', sans-serif;
                    min-height: 100vh;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    padding: 20px;
                }
                .privacy-container {
                    background: rgba(30, 30, 45, 0.9);
                    border-radius: 20px;
                    padding: 35px;
                    width: 100%;
                    max-width: 500px;
                    box-shadow: 0 15px 40px rgba(0,0,0,0.5);
                    border: 2px solid #f72585;
                    max-height: 80vh;
                    overflow-y: auto;
                }
                .privacy-title {
                    text-align: center;
                    font-size: 32px;
                    color: #f72585;
                    margin-bottom: 25px;
                }
                .privacy-content {
                    color: #b0b0c0;
                    line-height: 1.7;
                    font-size: 15px;
                }
                .privacy-content h3 {
                    color: #4cc9f0;
                    margin: 20px 0 10px;
                    font-size: 18px;
                }
                .privacy-button {
                    background: #f72585;
                    color: white;
                    border: none;
                    padding: 12px 30px;
                    border-radius: 25px;
                    font-size: 16px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    display: block;
                    margin: 30px auto 0;
                    font-family: 'Noto Sans Sinhala', sans-serif;
                }
                .privacy-button:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 10px 25px rgba(247, 37, 133, 0.4);
                }
            </style>
            <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Sinhala:wght@400;500;600;700&display=swap" rel="stylesheet">
        </head>
        <body>
            <div class="privacy-container">
                <h1 class="privacy-title">රහස්‍යතා ප්‍රතිපත්තිය</h1>
                <div class="privacy-content">
                    <h3>දත්ත රැස් කිරීම</h3>
                    <p>සිරි සිංහල ප්‍රෝ ඔබ ටයිප් කරන පාඨය දෘශ්‍යකරණය සහ පරිවර්තනය කිරීම සඳහා පමණක් භාවිතා කරයි. ඔබගේ පාඨය අපගේ සේවාදායකයන් වෙත යවනු නොලැබේ.</p>
                    
                    <h3>ස්ථානීය ගබඩා කිරීම</h3>
                    <p>ඔබගේ පාඨය ඔබගේ බ්‍රව්සරයේ localStorage හි සුරකිනු ලැබේ, එනම් එය ඔබගේ පරිගණකයේ පමණක් ගබඩා වන අතර අපට ප්‍රවේශයක් නැත.</p>
                    
                    <h3>කුකීස්</h3>
                    <p>මෙම යෙදුම කුකීස් භාවිතා නොකරයි හෝ ඔබගේ පෞද්ගලික දත්ත රැස් නොකරයි.</p>
                    
                    <h3>තෙවන පාර්ශ්ව සේවා</h3>
                    <p>වචන අනුමැතිය සඳහා අපි Google Input Tools API භාවිතා කරමු. ඔබ ටයිප් කරන වචන එම සේවාව වෙත යවනු ලැබේ.</p>
                    
                    <h3>දත්ත ආරක්ෂාව</h3>
                    <p>ඔබගේ සියලුම දත්ත ඔබගේ බ්‍රව්සරය තුළම රඳවාගෙන සිටින අතර අපගේ පාලනයෙන් බැහැර කිසිදු සේවාදායකයකට යවනු නොලැබේ.</p>
                    
                    <h3>ප්‍රතිපත්තියේ වෙනස්කම්</h3>
                    <p>මෙම රහස්‍යතා ප්‍රතිපත්තිය වෙනස් කළ හැකිය. වෙනස්කම් සිදුවුවහොත් එය මෙම පිටුවේ යාවත්කාලීන කරනු ලැබේ.</p>
                </div>
                <button class="privacy-button" onclick="window.close()">වසන්න</button>
            </div>
        </body>
        </html>
    `;
    
    openCenteredPopup(popupContent, 550, 700, 'රහස්‍යතා ප්‍රතිපත්තිය | සිරි සිංහල ප්‍රෝ');
});

// Function to create Contact page (සම්බන්ධ වන්න)
contactLink.addEventListener('click', function(e) {
    e.preventDefault();
    
    const popupContent = `
        <!DOCTYPE html>
        <html lang="si">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>සම්බන්ධ වන්න | සිරි සිංහල ප්‍රෝ</title>
            <style>
                * { margin: 0; padding: 0; box-sizing: border-box; }
                body {
                    background: linear-gradient(135deg, #0a0a0f, #1a1a2e);
                    color: white;
                    font-family: 'Noto Sans Sinhala', 'Inter', sans-serif;
                    min-height: 100vh;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    padding: 20px;
                }
                .contact-container {
                    background: rgba(30, 30, 45, 0.9);
                    border-radius: 20px;
                    padding: 35px;
                    width: 100%;
                    max-width: 500px;
                    box-shadow: 0 15px 40px rgba(0,0,0,0.5);
                    border: 2px solid #ff9e00;
                }
                .contact-title {
                    text-align: center;
                    font-size: 32px;
                    color: #ff9e00;
                    margin-bottom: 30px;
                }
                .contact-method {
                    background: rgba(255,255,255,0.05);
                    border-radius: 15px;
                    padding: 20px;
                    margin-bottom: 20px;
                    border-left: 4px solid #ff9e00;
                }
                .contact-icon {
                    color: #ff9e00;
                    font-size: 24px;
                    margin-bottom: 10px;
                }
                .contact-method h3 {
                    color: #4cc9f0;
                    margin-bottom: 10px;
                    font-size: 18px;
                }
                .contact-method p {
                    color: #b0b0c0;
                    line-height: 1.6;
                    margin-bottom: 15px;
                }
                .contact-button {
                    background: #ff9e00;
                    color: black;
                    border: none;
                    padding: 10px 25px;
                    border-radius: 20px;
                    font-size: 15px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    text-decoration: none;
                    display: inline-block;
                    font-weight: 600;
                }
                .contact-button:hover {
                    background: #ff9100;
                    transform: translateY(-2px);
                }
                .close-contact-button {
                    background: rgba(255,255,255,0.1);
                    color: white;
                    border: 1px solid rgba(255,255,255,0.2);
                    padding: 12px 30px;
                    border-radius: 25px;
                    margin-top: 20px;
                    cursor: pointer;
                    font-size: 16px;
                    display: block;
                    margin: 30px auto 0;
                }
            </style>
            <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Sinhala:wght@400;500;600;700&display=swap" rel="stylesheet">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        </head>
        <body>
            <div class="contact-container">
                <h1 class="contact-title">සම්බන්ධ වන්න</h1>
                
                <div class="contact-method">
                    <div class="contact-icon">
                        <i class="fab fa-telegram"></i>
                    </div>
                    <h3>Telegram</h3>
                    <p>සහන සහාය සඳහා අපගේ Telegram නාලිකාව හරහා සම්බන්ධ වන්න.</p>
                    <a href="https://t.me/mataberiyo" target="_blank" class="contact-button">
                        <i class="fab fa-telegram"></i> @mataberiyo
                    </a>
                </div>
                
                <div class="contact-method">
                    <div class="contact-icon">
                        <i class="fas fa-user-tie"></i>
                    </div>
                    <h3>නිර්මාතෘ</h3>
                    <p>සිරි සිංහල ප්‍රෝ නිර්මාණය කර ඇත්තේ KUDDA විසිනි.</p>
                </div>
                
                <div class="contact-method">
                    <div class="contact-icon">
                        <i class="fas fa-bug"></i>
                    </div>
                    <h3>දෝෂ වාර්තා කිරීම</h3>
                    <p>ඔබ දෝෂයක් හමු වුවහොත්, Telegram හරහා වාර්තා කරන්න.</p>
                </div>
                
                <button class="close-contact-button" onclick="window.close()">වසන්න</button>
            </div>
        </body>
        </html>
    `;
    
    openCenteredPopup(popupContent, 550, 700, 'සම්බන්ධ වන්න | සිරි සිංහල ප්‍රෝ');
});

</script>

<!-- Anime Assistant with Komi Character -->
<div class="anime-assistant" id="animeAssistant">
    
    <!-- Komi Character at Top -->
    <div class="komi-character-container">
        <div class="komi-wrapper">
            <div class="komi">
                <div class="komi-head">
                    <div class="komi-hair-back">
                        <div class="komi-hair-back-1"></div>
                    </div>
                    <div class="komi-ear komi-ear-left"></div>
                    <div class="komi-ear komi-ear-right"></div>
                    <div class="komi-cat-ear komi-cat-ear-left">
                        <div class="komi-cat-ear-fur"></div>
                    </div>
                    <div class="komi-cat-ear komi-cat-ear-right">
                        <div class="komi-cat-ear-fur"></div>
                    </div>
                    <div class="komi-hair-strand"></div>
                    <div class="komi-face"></div>
                    <div class="komi-hair-bangs">
                        <div class="komi-hair-bangs-1"></div>
                        <div class="komi-hair-bangs-2"></div>
                        <div class="komi-hair-bangs-3"></div>
                    </div>
                    <div class="komi-face-inner">
                        <div class="komi-eye komi-eye-left">
                            <div class="komi-eye-pupil">
                                <div class="komi-eye-sparkle"></div>
                            </div>
                        </div>
                        <div class="komi-eye komi-eye-right">
                            <div class="komi-eye-pupil">
                                <div class="komi-eye-sparkle"></div>
                            </div>
                        </div>
                        <div class="komi-blush komi-blush-left"></div>
                        <div class="komi-blush komi-blush-right"></div>
                    </div>
                </div>
                <div class="komi-panel">
                    <div class="komi-hair-extension"></div>
                    <div class="komi-body">
                        <div class="komi-neck">
                            <div class="komi-neck-shadow"></div>
                            <div class="komi-collar komi-collar-left"></div>
                            <div class="komi-collar komi-collar-right"></div>
                            <div class="komi-bow">
                                <div class="komi-bow-top">
                                    <div class="komi-bow-top-shadow"></div>
                                </div>
                                <div class="komi-bow-bottom"></div>
                            </div>
                        </div>
                        <div class="komi-shirt">
                            <div class="komi-shirt-sleeves"></div>
                            <div class="komi-shirt-sleeves-shadow"></div>
                        </div>
                    </div>
                </div>
                <div class="komi-zigzag komi-zigzag-1"></div>
                <div class="komi-zigzag komi-zigzag-2"></div>
                <div class="komi-zigzag komi-zigzag-3"></div>
                <div class="komi-zigzag komi-zigzag-4"></div>
                <div class="komi-zigzag komi-zigzag-5"></div>
                <div class="komi-zigzag komi-zigzag-6"></div>
                <div class="komi-zigzag komi-zigzag-7"></div>
                <div class="komi-zigzag komi-zigzag-8"></div>
                <div class="komi-zigzag komi-zigzag-9"></div>
                <div class="komi-zigzag komi-zigzag-10"></div>
                <div lang="ja" class="komi-buruburu">
                    <span class="komi-buruburu-character komi-buruburu-character-1">ブ</span>
                    <span class="komi-buruburu-character komi-buruburu-character-2">ル</span>
                    <span class="komi-buruburu-character komi-buruburu-character-3">ル</span>
                    <span class="komi-buruburu-character komi-buruburu-character-4">ル</span>
                    <span class="komi-buruburu-character komi-buruburu-character-5">ル</span>
                    <span class="komi-buruburu-character komi-buruburu-character-6">ル</span>
                </div>
            </div>
        </div>
        <div class="komi-title">
            <h3 class="shortcuts-title">
                <i class="fas fa-cat"></i> කොමි සහායකයා
            </h3>
        </div>
    </div>
    
    <!-- Speech at Bottom -->
    <div class="anime-speech" id="animeSpeech">
        සුබ දවසක්! මම ඔබගේ සිංහල ලේඛන සහායකයා. ටයිප් කිරීම ආරම්භ කරන්න!
    </div>
</div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <div class="notification-icon" id="notificationIcon">
            <i class="fas fa-info-circle"></i>
        </div>
        <div class="notification-content">
            <div class="notification-title" id="notificationTitle">තොරතුරු</div>
            <div class="notification-message" id="notificationMessage">පණිවුඩය මෙහි දිස්වේ</div>
        </div>
        <button class="notification-close" id="notificationClose">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <script>
        // DOM Elements
const editor = document.getElementById('editor');
const suggestionMenu = document.getElementById('suggestionMenu');
const statusText = document.getElementById('statusText');
const wordCount = document.getElementById('wordCount');
const charCount = document.getElementById('charCount');
const suggestionCount = document.getElementById('suggestionCount');
const menuCount = document.getElementById('menuCount');
const currentWord = document.getElementById('currentWord');
const lastUpdate = document.getElementById('lastUpdate');
const clearBtn = document.getElementById('clearBtn');
const demoBtn = document.getElementById('demoBtn');
const tutorialBtn = document.getElementById('tutorialBtn');
const progressFill = document.getElementById('progressFill');
const progressText = document.getElementById('progressText');
const progressPercent = document.getElementById('progressPercent');
const notification = document.getElementById('notification');
const notificationTitle = document.getElementById('notificationTitle');
const notificationMessage = document.getElementById('notificationMessage');
const notificationIcon = document.getElementById('notificationIcon');
const notificationClose = document.getElementById('notificationClose');
const animeAssistant = document.getElementById('animeAssistant');
const animeSpeech = document.getElementById('animeSpeech');
const autoGuide = document.getElementById('autoGuide');
const guideContent = document.getElementById('guideContent');
const guideClose = document.getElementById('guideClose');
const exampleTypeContainer = document.getElementById('exampleTypeContainer');
const exampleTypeCards = document.querySelectorAll('.example-type-card');
const komiCharacter = document.querySelector('.komi');

// State variables
let selectedIndex = 0;
let suggestions = [];
let currentTypedWord = "";
let currentWordStartPos = 0;
let wordHistory = [];
let tutorialActive = false;
let tutorialStep = 0;
let lastTypedTime = Date.now();
let inactivityTimer;
let selectedExampleType = 'basic';

// Word definitions for auto-guide
const wordDefinitions = {
    "mama": { meaning: "මම - ප්‍රථම පුරුෂ ඒකවචන සර්වනාමය", example: "මම පාසැල් යනවා" },
    "oyaa": { meaning: "ඔයා - මධ්‍යම පුරුෂ ඒකවචන සර්වනාමය", example: "ඔයා කොහෙද යන්නේ?" },
    "eya": { meaning: "එයා - තුන්වන පුරුෂ ඒකවචන සර්වනාමය", example: "එයා ගෙදර යනවා" },
    "api": { meaning: "අපි - ප්‍රථම පුරුෂ බහුවචන සර්වනාමය", example: "අපි එකට යමු" },
    "kohomada": { meaning: "කොහොමද - ප්‍රශ්නාර්ථ පදය", example: "ඔබට කොහොමද?" },
    "hondai": { meaning: "හොඳයි - ස්තුති ප්‍රකාශනය", example: "මට හොඳයි" },
    "stuthi": { meaning: "ස්තුතියි - ස්තුති ප්‍රකාශනය", example: "ඔබට ස්තුතියි" },
    "liyanne": { meaning: "ලියන්නේ - ක්‍රියාපදය", example: "මම ලියන්නේ" },
    "sinhalen": { meaning: "සිංහලෙන් - ක්‍රියා විශේෂණය", example: "සිංහලෙන් කතා කරන්න" },
    "malli": { meaning: "මල්ලි - සහෝදරයා/යුවතිය", example: "මල්ලි, එන්න" },
    "akka": { meaning: "අක්කා - වැඩිමහල් සහෝදරිය", example: "අක්කා කොහෙද?" }
};

// Example texts for different types
const exampleTexts = {
    basic: `mama sinhalen liyanne kohomada? me app eka hondai. oyaata stuthi!

api sinhaal bhashawa hondata igenaganna puluwan. meya upayogakaramayi.`,
    
    conversation: `malli: ayubowan! kohomada oyaa?
akka: stuthi, mama hondai. oyaa kohomada?
malli: mama hondai. ada kumakda karanne?
akka: mama pothak kiyadanawa. oyaa?
malli: mama sinhaal igenaganawa.`,
    
    story: `eka thara gamaka sulu pirisak jeewath wuha. ovunge jeewithaya sarala ha sathutin piriyuni. sama udeasanakma ovun samangi wada aarambha karanu labee.

eka dinak nawa mithurek gamata paminne. ohu aluth dhanumak gena aave.`,
    
    formal: `sathkara yothumani,

me lipiyen api sinhaal bhashawe wadagathkam saha warthaman thakshanaya samanga ehi bhawithaya pilibanda sakhachcha karamu.

sinhaal bhashawa apage jathika urumayak. eya surakima saha warthanaya kireema apa samage yuthukamak.`,
    
    guide: `ආයුබෝවන්! මම ඔබගේ ස්වයං උපදේශකයා.

මෙම මෙවලමෙන් ඔබට:
1. singlish වලින් සිංහලට ක්ෂණිකව හැරවිය හැක
2. වචන අර්ථ දැක්වීම් ලබා ගත හැක
3. ව්‍යාකරණ උපදෙස් ලබා ගත හැක
4. ස්වයංක්‍රීයව ලිවීමට පුහුණු විය හැක

උදාහරණයක් ලෙස: "mama" ටයිප් කර enter ඔබන්න. Tab යතුර ඔබන්න.`
};

// Initialize
updateCounts();
updateLastUpdateTime();
startInactivityTimer();
setupExampleTypeSelection();
setupKomiInteractions();

// Event Listeners
editor.addEventListener('input', handleInput);
editor.addEventListener('keydown', handleKeyDown);
editor.addEventListener('click', hideSuggestionMenu);
editor.addEventListener('focus', () => {
    animeAssistant.style.display = 'block';
    showAnimeSpeech("ටයිප් කිරීම ආරම්භ කරන්න! මම ඔබට උපකාර කරමි.");
});
editor.addEventListener('blur', () => {
    setTimeout(() => {
        if (!editor.matches(':focus')) {
            animeAssistant.style.display = 'none';
        }
    }, 3000);
});

clearBtn.addEventListener('click', clearEditor);
demoBtn.addEventListener('click', loadDemoText);
tutorialBtn.addEventListener('click', startTutorial);
notificationClose.addEventListener('click', hideNotification);
guideClose.addEventListener('click', () => {
    autoGuide.style.display = 'none';
});
animeAssistant.addEventListener('click', () => {
    showAnimeSpeech("මම ඔබගේ සිංහල ලේඛන සහායකයා! ඕනෑම වචනයක් ටයිප් කරන්න, මම අරුත් දෙන්නෙමි.");
});

// Auto-save
setInterval(autoSave, 30000);

// Setup example type selection
function setupExampleTypeSelection() {
    exampleTypeCards.forEach(card => {
        card.addEventListener('click', () => {
            // Remove active class from all cards
            exampleTypeCards.forEach(c => c.classList.remove('active'));
            
            // Add active class to clicked card
            card.classList.add('active');
            
            // Set selected example type
            selectedExampleType = card.dataset.type;
            
            // Update anime speech
            const typeNames = {
                'basic': 'මූලික',
                'conversation': 'සංවාද',
                'story': 'කතාව',
                'formal': 'විධිමත්',
                'guide': 'ස්වයං උපදේශක'
            };
            
            showAnimeSpeech(`${typeNames[selectedExampleType]} උදාහරණ වර්ගය තෝරාගත්තා! "උදාහරණය" බොත්තම ඔබන්න.`);
        });
    });
    
    // Set first card as active by default
    exampleTypeCards[0].classList.add('active');
}

// Setup Komi character interactions
function setupKomiInteractions() {
    komiCharacter.addEventListener('mouseenter', () => {
        showAnimeSpeech("ආයුබෝවන්! මම කොමි. ඔබට සිංහල ලියන්න උපකාර කරන්න මට සතුටක්!");
    });
    
    komiCharacter.addEventListener('click', () => {
        const messages = [
            "ඔබගේ ලිවීම ඉතා යහපත්ය!",
            "සිංහල භාෂාව ඉතා සුන්දරයි නේද?",
            "මට ඔබගේ ලිවීමට උපකාර කිරීමට ආශාවක්!",
            "තවත් වචන ටයිප් කරන්න, මම උපකාර කරමි!"
        ];
        const randomMessage = messages[Math.floor(Math.random() * messages.length)];
        showAnimeSpeech(randomMessage);
    });
}

// Handle input
async function handleInput(e) {
    updateCounts();
    updateProgress();
    updateLastUpdateTime();
    resetInactivityTimer();
    
    const text = editor.value;
    const cursorPos = editor.selectionStart;
    
    // Extract current word
    const { word, startPos } = extractCurrentWord(text, cursorPos);
    currentTypedWord = word;
    currentWordStartPos = startPos;
    
    // Show auto-guide for certain words
    if (currentTypedWord.length > 2) {
        const definition = wordDefinitions[currentTypedWord.toLowerCase()];
        if (definition) {
            showAutoGuide(definition.meaning, definition.example);
        } else if (currentTypedWord.length > 4) {
            // Show general typing tips
            const tips = [
                "වචනය නිවැරදිව ටයිප් කරන්න. Singlish හි අකුරු වලට අවධානය යොමු කරන්න.",
                "වචනය සම්පූර්ණ කිරීමෙන් පසු අනුමැතියන් බලන්න. Tab යතුර ඔබන්න.",
                "විශේෂ අකුරු (ඇ, ඈ, ඉ, ඊ) සඳහා අනුරූප Singlish අකුරු භාවිතා කරන්න."
            ];
            const randomTip = tips[Math.floor(Math.random() * tips.length)];
            showAutoGuide("ටයිප් කිරීමේ උපදෙස්", randomTip);
        }
    }
    
    // Update current word display
    if (currentTypedWord.length > 0) {
        currentWord.textContent = `වර්තමාන වචනය: "${currentTypedWord}"`;
        statusText.textContent = `"${currentTypedWord}" සඳහා සොයමින්...`;
        statusText.style.color = "#4cc9f0";
        
        // Add to word history
        if (!wordHistory.includes(currentTypedWord.toLowerCase())) {
            wordHistory.push(currentTypedWord.toLowerCase());
            if (wordHistory.length > 50) wordHistory.shift();
        }
        
        await getSuggestions(currentTypedWord);
    } else {
        currentWord.textContent = "වර්තමාන වචනය: ";
        statusText.textContent = "සුසරණය";
        statusText.style.color = "#4cc9f0";
        hideSuggestionMenu();
        autoGuide.style.display = 'none';
    }
}

// Extract current word
function extractCurrentWord(text, cursorPos) {
    let start = cursorPos - 1;
    while (start >= 0 && !isWordSeparator(text[start])) {
        start--;
    }
    start++;
    
    let end = cursorPos;
    while (end < text.length && !isWordSeparator(text[end])) {
        end++;
    }
    
    const word = text.substring(start, end);
    return { word, startPos: start };
}

function isWordSeparator(char) {
    return char === ' ' || char === '\n' || char === '.' || char === ',' || 
           char === '!' || char === '?' || char === ';' || char === ':' || 
           char === '(' || char === ')' || char === '"' || char === "'";
}

// Get suggestions from Google Input Tools
async function getSuggestions(word) {
    if (word.length < 1) {
        hideSuggestionMenu();
        return;
    }
    
    statusText.textContent = `"${word}" සඳහා සොයමින්...`;
    
    const url = `https://inputtools.google.com/request?text=${encodeURIComponent(word)}&itc=si-t-i0-und&num=9&cp=0&cs=1&ie=utf-8&oe=utf-8`;
    
    try {
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 3000);
        
        const response = await fetch(url, { signal: controller.signal });
        clearTimeout(timeoutId);
        
        if (!response.ok) throw new Error(`API Error: ${response.status}`);
        
        const data = await response.json();
        
        if (data[0] === 'SUCCESS') {
            suggestions = data[1][0][1];
            
            if (suggestions && suggestions.length > 0) {
                showSuggestionMenu();
                statusText.textContent = `${suggestions.length} අනුමැතිය(න්) හමු විය`;
                statusText.style.color = "#4cc9f0";
                suggestionCount.textContent = suggestions.length;
            } else {
                hideSuggestionMenu();
                statusText.textContent = "අනුමැතියන් නොමැත";
                statusText.style.color = "#f72585";
            }
        } else {
            throw new Error('Invalid API response');
        }
    } catch (err) {
        console.warn('Suggestion error:', err);
        statusText.textContent = "දෝෂයක් - අන්තර්ජාලය පරීක්ෂා කරන්න";
        statusText.style.color = "#f72585";
        hideSuggestionMenu();
    }
}

// Show suggestion menu
function showSuggestionMenu() {
    suggestionMenu.innerHTML = '';
    
    // Add header
    const header = document.createElement('div');
    header.className = 'suggestion-header';
    header.innerHTML = `<span>අනුමැතියන්</span><span id="menuCount">${suggestions.length}</span>`;
    suggestionMenu.appendChild(header);
    
    // Add suggestion items
    suggestions.forEach((suggestion, index) => {
        const div = document.createElement('div');
        div.className = 'suggestion-item' + (index === 0 ? ' active' : '');
        div.innerHTML = `<span class="suggestion-index">${index + 1}</span> ${suggestion}`;
        div.onclick = () => applySuggestion(suggestion);
        suggestionMenu.appendChild(div);
    });
    
    // Position menu
    positionMenu();
    suggestionMenu.style.display = 'flex';
    selectedIndex = 0;
}

// Position menu near cursor
function positionMenu() {
    const textareaRect = editor.getBoundingClientRect();
    const cursorPos = editor.selectionStart;
    
    // Create temporary span to measure cursor position
    const tempSpan = document.createElement('span');
    const textBeforeCursor = editor.value.substring(0, cursorPos);
    tempSpan.textContent = textBeforeCursor;
    tempSpan.style.whiteSpace = 'pre-wrap';
    tempSpan.style.font = window.getComputedStyle(editor).font;
    tempSpan.style.visibility = 'hidden';
    tempSpan.style.position = 'absolute';
    document.body.appendChild(tempSpan);
    
    const lineHeight = parseInt(window.getComputedStyle(editor).lineHeight);
    const lines = textBeforeCursor.split('\n');
    const currentLine = lines.length - 1;
    const currentLineText = lines[currentLine];
    
    const lineSpan = document.createElement('span');
    lineSpan.textContent = currentLineText;
    lineSpan.style.font = window.getComputedStyle(editor).font;
    lineSpan.style.visibility = 'hidden';
    document.body.appendChild(lineSpan);
    
    const cursorX = lineSpan.offsetWidth;
    const cursorY = currentLine * lineHeight;
    
    document.body.removeChild(tempSpan);
    document.body.removeChild(lineSpan);
    
    // Calculate position
    let menuX = textareaRect.left + cursorX + 20;
    let menuY = textareaRect.top + cursorY + lineHeight + 5;
    
    // Keep menu within viewport
    const viewportWidth = window.innerWidth;
    const menuWidth = suggestionMenu.offsetWidth || 280;
    const viewportHeight = window.innerHeight;
    const menuHeight = suggestionMenu.offsetHeight || 200;
    
    if (menuX + menuWidth > viewportWidth - 20) {
        menuX = viewportWidth - menuWidth - 20;
    }
    
    if (menuY + menuHeight > viewportHeight - 20) {
        menuY = viewportHeight - menuHeight - 20;
    }
    
    suggestionMenu.style.left = `${menuX}px`;
    suggestionMenu.style.top = `${menuY}px`;
}

// Update menu selection
function updateMenuSelection() {
    const items = suggestionMenu.querySelectorAll('.suggestion-item');
    items.forEach((item, i) => {
        item.classList.toggle('active', i === selectedIndex);
    });
}

// Apply selected suggestion
function applySuggestion(selectedWord) {
    if (!selectedWord) return;
    
    const text = editor.value;
    const newText = text.substring(0, currentWordStartPos) + 
                   selectedWord + 
                   text.substring(currentWordStartPos + currentTypedWord.length);
    
    editor.value = newText;
    
    const newCursorPos = currentWordStartPos + selectedWord.length;
    editor.setSelectionRange(newCursorPos, newCursorPos);
    
    hideSuggestionMenu();
    editor.focus();
    updateCounts();
    
    statusText.textContent = "තෝරා ගන්නා ලදී ✓";
    statusText.style.color = "#4cc9f0";
    
    showAnimeSpeech(`හොඳයි! "${selectedWord}" වචනය යොදා ඇත.`);
    
    setTimeout(() => {
        statusText.textContent = "සුසරණය";
    }, 1000);
}

// Handle keyboard shortcuts
function handleKeyDown(e) {
    // Global shortcuts (Ctrl + key)
    if (e.ctrlKey) {
        switch(e.key.toLowerCase()) {
            case 's':
                e.preventDefault();
                autoSave(true);
                return;
            case 't':
                e.preventDefault();
                startTutorial();
                return;
            case 'g':
                e.preventDefault();
                toggleAutoGuide();
                return;
            case 'd':
                e.preventDefault();
                loadDemoText();
                return;
            case 'c':
                if (!e.shiftKey) return;
                e.preventDefault();
                clearEditor();
                return;
            case '1':
                e.preventDefault();
                selectExampleType('basic');
                return;
            case '2':
                e.preventDefault();
                selectExampleType('conversation');
                return;
            case '3':
                e.preventDefault();
                selectExampleType('story');
                return;
            case '4':
                e.preventDefault();
                selectExampleType('formal');
                return;
            case '5':
                e.preventDefault();
                selectExampleType('guide');
                return;
        }
    }
    
    // If menu is visible
    if (suggestionMenu.style.display === 'flex') {
        switch(e.key) {
            case 'ArrowDown':
                e.preventDefault();
                selectedIndex = (selectedIndex + 1) % suggestions.length;
                updateMenuSelection();
                break;
                
            case 'ArrowUp':
                e.preventDefault();
                selectedIndex = (selectedIndex - 1 + suggestions.length) % suggestions.length;
                updateMenuSelection();
                break;
                
            case 'Enter':
            case ' ':
                if (!e.repeat) {
                    e.preventDefault();
                    applySuggestion(suggestions[selectedIndex]);
                }
                break;
                
            case 'Tab':
                e.preventDefault();
                applySuggestion(suggestions[0]);
                break;
                
            case 'Escape':
                e.preventDefault();
                hideSuggestionMenu();
                break;
                
            // Number keys 1-9
            case '1': case '2': case '3': case '4': case '5':
            case '6': case '7': case '8': case '9':
                const num = parseInt(e.key) - 1;
                if (num < suggestions.length) {
                    e.preventDefault();
                    applySuggestion(suggestions[num]);
                }
                break;
        }
    } else if (e.key === 'Escape') {
        hideSuggestionMenu();
    }
    
    // Reset inactivity timer on any key press
    resetInactivityTimer();
}

// Select example type programmatically
function selectExampleType(type) {
    exampleTypeCards.forEach(card => {
        card.classList.remove('active');
        if (card.dataset.type === type) {
            card.classList.add('active');
            selectedExampleType = type;
            
            const typeNames = {
                'basic': 'මූලික',
                'conversation': 'සංවාද',
                'story': 'කතාව',
                'formal': 'විධිමත්',
                'guide': 'ස්වයං උපදේශක'
            };
            
            showAnimeSpeech(`${typeNames[type]} උදාහරණ වර්ගය තෝරාගත්තා!`);
        }
    });
}

// Hide suggestion menu
function hideSuggestionMenu() {
    suggestionMenu.style.display = 'none';
    suggestions = [];
    selectedIndex = 0;
}

// Show auto-guide
function showAutoGuide(title, content) {
    guideContent.innerHTML = `<strong>${title}</strong><br>${content}`;
    autoGuide.style.display = 'block';
}

// Toggle auto-guide
function toggleAutoGuide() {
    if (autoGuide.style.display === 'block') {
        autoGuide.style.display = 'none';
    } else {
        showAutoGuide("ස්වයං උපදේශකයා", "මම ඔබට ටයිප් කිරීමේදී උපදෙස් දෙන්නෙමි. වචන අර්ථ දැක්වීම් සහ ව්‍යාකරණ උපදෙස් ලබා ගැනීමට ටයිප් කරන්න...");
    }
}

// Show anime speech
function showAnimeSpeech(message) {
    animeSpeech.textContent = message;
    animeSpeech.style.display = 'block';
    
    setTimeout(() => {
        animeSpeech.style.display = 'none';
    }, 5000);
}

// Update word and character counts
function updateCounts() {
    const text = editor.value;
    const words = text.trim().split(/\s+/).filter(word => word.length > 0);
    
    wordCount.textContent = words.length;
    charCount.textContent = text.length;
}

// Update last update time
function updateLastUpdateTime() {
    const now = new Date();
    const timeString = now.toLocaleTimeString('si-LK', { 
        hour: '2-digit', 
        minute: '2-digit'
    });
    lastUpdate.textContent = timeString;
}

// Update progress
function updateProgress() {
    const text = editor.value;
    const words = text.trim().split(/\s+/).filter(word => word.length > 0);
    const uniqueWords = [...new Set(words.map(w => w.toLowerCase()))];
    
    let progress = 0;
    let level = "ආරම්භකයා";
    
    if (words.length >= 500) {
        progress = 100;
        level = "විශේෂඥයා";
    } else if (words.length >= 250) {
        progress = 75;
        level = "පළපුරුද්දක්";
    } else if (words.length >= 100) {
        progress = 50;
        level = "මධ්‍යස්ථයා";
    } else if (words.length >= 50) {
        progress = 25;
        level = "අභ්‍යාසකරු";
    } else if (words.length >= 10) {
        progress = 10;
        level = "ආරම්භකයා";
    }
    
    progressFill.style.width = `${progress}%`;
    progressText.textContent = `${level} (${uniqueWords.length} අනන්‍ය වචන)`;
    progressPercent.textContent = `${progress}%`;
}

// Show notification
function showNotification(title, message, type = "info") {
    notificationTitle.textContent = title;
    notificationMessage.textContent = message;
    
    let icon = "info-circle";
    if (type === "success") icon = "check-circle";
    if (type === "warning") icon = "exclamation-triangle";
    if (type === "error") icon = "times-circle";
    
    notificationIcon.innerHTML = `<i class="fas fa-${icon}"></i>`;
    
    notification.style.display = "flex";
    
    setTimeout(() => {
        hideNotification();
    }, 5000);
}

// Hide notification
function hideNotification() {
    notification.style.display = "none";
}

// Clear editor
function clearEditor() {
    if (editor.value.length > 0) {
        if (confirm("ඔබට ඇත්තටම මෙම පාඨය හිස් කිරීමට අවශ්‍යද?")) {
            editor.value = '';
            editor.focus();
            updateCounts();
            hideSuggestionMenu();
            
            showAnimeSpeech("සියලුම පාඨය හිස් කරන ලදී. නව ලිපියක් ආරම්භ කරන්න!");
            
            statusText.textContent = "හිස් කරන ලදී";
            statusText.style.color = "#f72585";
            
            setTimeout(() => {
                statusText.textContent = "සුසරණය";
                statusText.style.color = "#4cc9f0";
            }, 1500);
        }
    }
}

// Load demo text
function loadDemoText() {
    const demoText = exampleTexts[selectedExampleType] || exampleTexts.basic;
    
    editor.value = demoText;
    editor.focus();
    updateCounts();
    
    // Set cursor at the beginning
    editor.setSelectionRange(0, 0);
    
    if (selectedExampleType === 'guide') {
        showAutoGuide("ස්වයං උපදේශක මාදිලිය", "මෙම මාදිලියෙන් ඔබට පියවරෙන් පියවර උපදෙස් ලබා ගත හැක. වචන අර්ථ සහ ව්‍යාකරණ උපදෙස් ස්වයංක්‍රීයව ලබා දේ.");
    }
    
    const typeNames = {
        'basic': 'මූලික',
        'conversation': 'සංවාද',
        'story': 'කතාව',
        'formal': 'විධිමත්',
        'guide': 'ස්වයං උපදේශක'
    };
    
    showAnimeSpeech(`${typeNames[selectedExampleType]} උදාහරණය පූරණය කරන ලදී! ටයිප් කිරීම අත්හදා බලන්න.`);
    
    statusText.textContent = "උදාහරණ පාඨය පූරණය කරන ලදී";
    statusText.style.color = "#4cc9f0";
    
    setTimeout(() => {
        statusText.textContent = "සුසරණය";
    }, 2000);
}

// Start tutorial
function startTutorial() {
    if (tutorialActive) {
        tutorialActive = false;
        tutorialBtn.innerHTML = '<i class="fas fa-graduation-cap"></i> උපදේශනය';
        showAnimeSpeech("උපදේශනය නවතා දැමිණි. නැවත ආරම්භ කිරීමට බොත්තම ඔබන්න.");
        return;
    }
    
    tutorialActive = true;
    tutorialStep = 0;
    tutorialBtn.innerHTML = '<i class="fas fa-stop"></i> නවතන්න';
    
    const tutorialSteps = [
        { text: "mama", delay: 2500, message: "මම - ප්‍රථම පුරුෂ ඒකවචන සර්වනාමය" },
        { text: "oyaa", delay: 2500, message: "ඔයා - මධ්‍යම පුරුෂ ඒකවචන සර්වනාමය" },
        { text: "eya", delay: 2500, message: "එයා - තුන්වන පුරුෂ ඒකවචන සර්වනාමය" },
        { text: "api", delay: 2500, message: "අපි - ප්‍රථම පුරුෂ බහුවචන සර්වනාමය" },
        { text: "kohomada", delay: 2500, message: "කොහොමද - ප්‍රශ්නාර්ථ පදය (කෙසේද?)" },
        { text: "mama sinhalen liyanne", delay: 3500, message: "මම සිංහලෙන් ලියන්නේ - සම්පූර්ණ වාක්‍යයක්" },
        { text: "meyam honda app ekak", delay: 3500, message: "මෙයම හොඳ ඇප් එකක් - තවත් වාක්‍යයක්" }
    ];
    
    function runTutorialStep() {
        if (!tutorialActive || tutorialStep >= tutorialSteps.length) {
            tutorialActive = false;
            tutorialBtn.innerHTML = '<i class="fas fa-graduation-cap"></i> උපදේශනය';
            showAnimeSpeech("උපදේශනය සාර්ථකව අවසන් විය! දැන් ඔබම උත්සාහ කරන්න.");
            return;
        }
        
        const step = tutorialSteps[tutorialStep];
        editor.value = step.text;
        updateCounts();
        handleInput();
        
        showAutoGuide("උපදේශනය", step.message);
        showAnimeSpeech(step.message);
        
        tutorialStep++;
        setTimeout(runTutorialStep, step.delay);
    }
    
    showAnimeSpeech("උපදේශනය ආරම්භ විය! පියවරෙන් පියවර උපදෙස් ලබා ගන්න.");
    runTutorialStep();
}

// Start inactivity timer
function startInactivityTimer() {
    inactivityTimer = setInterval(() => {
        const now = Date.now();
        if (now - lastTypedTime > 30000 && editor.value.length > 0) { // 30 seconds
            showAnimeSpeech("ඔබ තවමත් ටයිප් කරනවාද? මට උපකාර කිරීමට අවශ්‍ය නම් කියන්න!");
        }
    }, 30000);
}

// Reset inactivity timer
function resetInactivityTimer() {
    lastTypedTime = Date.now();
}

// Auto-save
function autoSave(manual = false) {
    const text = editor.value;
    if (text.trim().length > 0) {
        localStorage.setItem('sinhalaProSavedText', text);
        localStorage.setItem('sinhalaProSaveTime', new Date().toISOString());
        
        if (manual) {
            showAnimeSpeech("පාඨය සාර්ථකව සුරක්ෂිත කරන ලදී!");
        }
    }
}

// Load saved text on page load
window.addEventListener('load', function() {
    const savedText = localStorage.getItem('sinhalaProSavedText');
    const saveTime = localStorage.getItem('sinhalaProSaveTime');
    
    if (savedText) {
        if (confirm("පෙර සුරකින ලද පාඨයක් හමු විය. එය පූරණය කරන්නද?")) {
            editor.value = savedText;
            updateCounts();
            updateProgress();
            
            if (saveTime) {
                const time = new Date(saveTime).toLocaleTimeString('si-LK');
                showAnimeSpeech(`පෙර පාඨය පූරණය කරන ලදී! ${time} වන විට සුරකින ලදී.`);
            }
        }
    }
    
    // Show welcome for first-time users
    if (!localStorage.getItem('sinhalaProIntroShown')) {
        setTimeout(() => {
            showAnimeSpeech("සාදරයෙන් පිළිගනිමු! සිරි සිංහල ප්‍රෝ වෙත සාදරයෙන් පිළිගනිමු. ටයිප් කිරීම ආරම්භ කරන්න!");
            
            localStorage.setItem('sinhalaProIntroShown', 'true');
        }, 1000);
    }
});

// Handle window resize
window.addEventListener('resize', () => {
    if (suggestionMenu.style.display === 'flex') {
        positionMenu();
    }
});

// Handle before unload
window.addEventListener('beforeunload', function(e) {
    if (editor.value.trim().length > 0) {
        autoSave();
    }
});
    </script>
</body>
</html>